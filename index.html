<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MAXI JDC MARKET</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f1522;
  color:#fff;
}

/* ===== PANIER BOUTON ===== */
.cart-fab{
  position:fixed;
  top:15px;
  right:15px;
  z-index:9999;
  background:#d4af37;
  color:#111;
  padding:10px 15px;
  border-radius:999px;
  font-weight:bold;
  cursor:pointer;
  border:none;
}
.cart-badge{
  background:#111;
  color:#fff;
  padding:2px 7px;
  border-radius:50%;
  margin-left:6px;
}

/* ===== PANIER ===== */
.cart-drawer{
  position:fixed;
  top:0;
  right:0;
  width:360px;
  max-width:95%;
  height:100vh;
  background:#111826;
  transform:translateX(100%);
  transition:0.3s;
  z-index:9998;
  display:flex;
  flex-direction:column;
}
.cart-drawer.open{transform:translateX(0);}

.cart-header{
  padding:15px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid #333;
}

.cart-body{flex:1;overflow:auto;padding:10px;}
.cart-item{border-bottom:1px solid #333;padding:8px 0;}
.cart-footer{padding:10px;border-top:1px solid #333;}

button{
  cursor:pointer;
  padding:8px 12px;
  border-radius:8px;
  border:none;
  font-weight:bold;
}
.btn-gold{background:#d4af37;color:#111;}
.btn-dark{background:#333;color:#fff;}

/* ===== MODAL ===== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10000;
}
.modal.open{display:flex;}
.modal-card{
  background:#111826;
  padding:15px;
  border-radius:12px;
  width:95%;
  max-width:400px;
}
.modal-card input, select, textarea{
  width:100%;
  margin:6px 0;
  padding:8px;
  border-radius:8px;
  border:none;
}
</style>
</head>

<body>

<!-- ===== BOUTON PANIER ===== -->
<button id="cartBtn" class="cart-fab">
ðŸ›’ Panier <span id="cartCount" class="cart-badge">0</span>
</button>

<!-- ===== PANIER ===== -->
<div id="cart" class="cart-drawer">
  <div class="cart-header">
    <strong>Votre panier</strong>
    <button onclick="toggleCart()">âœ–</button>
  </div>
  <div id="cartItems" class="cart-body"></div>
  <div class="cart-footer">
    Total : <strong id="cartTotal">0 DT</strong><br><br>
    <button class="btn-dark" onclick="clearCart()">Vider</button>
    <button class="btn-gold" onclick="openCheckout()">Valider</button>
  </div>
</div>

<!-- ===== MODAL CLIENT ===== -->
<div id="checkout" class="modal">
  <div class="modal-card">
    <h3>Informations client</h3>
    <input id="cName" placeholder="Nom & PrÃ©nom">
    <input id="cPhone" placeholder="TÃ©lÃ©phone">
    <select id="cMode" onchange="toggleAddress()">
      <option value="Livraison">Livraison</option>
      <option value="Retrait">Retrait magasin</option>
    </select>
    <input id="cAddress" placeholder="Adresse">
    <textarea id="cNote" placeholder="Note (optionnel)"></textarea>
    <br>
    <button class="btn-gold" onclick="sendWhatsApp()">Envoyer WhatsApp</button>
    <button class="btn-dark" onclick="closeCheckout()">Fermer</button>
  </div>
</div>

<script>
const WHATSAPP="21625600978";
let cart={};

function toggleCart(){
  document.getElementById("cart").classList.toggle("open");
}
document.getElementById("cartBtn").onclick=toggleCart;

function addToCart(code,name,price){
  if(!cart[code]) cart[code]={name,price,qty:0};
  cart[code].qty++;
  renderCart();
}

function renderCart(){
  let html="",total=0,count=0;
  for(let k in cart){
    let it=cart[k];
    let t=it.qty*it.price;
    total+=t; count+=it.qty;
    html+=`<div class="cart-item">
      ${it.name} x${it.qty} = ${t.toFixed(2)} DT
    </div>`;
  }
  document.getElementById("cartItems").innerHTML=html||"Panier vide";
  document.getElementById("cartTotal").innerText=total.toFixed(2)+" DT";
  document.getElementById("cartCount").innerText=count;
}

function clearCart(){cart={};renderCart();}

function openCheckout(){document.getElementById("checkout").classList.add("open");}
function closeCheckout(){document.getElementById("checkout").classList.remove("open");}

function toggleAddress(){
  document.getElementById("cAddress").style.display=
    document.getElementById("cMode").value==="Livraison"?"block":"none";
}

function sendWhatsApp(){
  let n=cName.value,p=cPhone.value,m=cMode.value,a=cAddress.value;
  if(!n||!p){alert("Nom et tÃ©lÃ©phone obligatoires");return;}
  let msg=`Commande MAXI JDC MARKET\nClient:${n}\nTel:${p}\nMode:${m}\n`;
  if(m==="Livraison") msg+=`Adresse:${a}\n`;
  for(let k in cart){
    let it=cart[k];
    msg+=`${it.name} x${it.qty}\n`;
  }
  window.open(`https://wa.me/${WHATSAPP}?text=`+encodeURIComponent(msg));
}
</script>

<!-- ===== EXEMPLE PRODUIT (TEST) ===== -->
<div style="padding:20px">
<h3>Produits test</h3>
<button onclick="addToCart('4124','GRAINES SARRASIN',6.5)">Ajouter Sarrasin</button>
<button onclick="addToCart('4830','THON GALITE',13.9)">Ajouter Thon</button>
</div>

</body>
</html>
